<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8"/>
  <title>Fusion Dashboard</title>
</head>
<body>
  <h1>Fusion Dashboard</h1>

  <div id="timeframeFilter">
    <select>
      <option>All</option><option>3D</option><option>5D</option>
      <option>10D</option><option>15D</option><option>30D</option>
    </select>
    <button id="refreshBtn" onclick="refresh()">Refresh</button>
  </div>

  <table id="topSignalsTable" border="1">
    <thead><tr><th>Symbol</th><th>Verdict</th><th>Confidence</th><th>5D Pred (%)</th>
                    <th>Signal Strength</th>
                    <th>Recommendation</th>
                    <th class="ai-verdict-column" style="display: none;">AI Verdict</th>
                </tr></thead>
    <tbody id="signalsTbody"></tbody>
  </table>

  <script>
    async function refresh(force=false){
      const url = '/api/fusion/dashboard' + (force ? '?forceRefresh=true' : '');
      const res = await fetch(url);
      const data = await res.json();
      const tbody = document.getElementById('signalsTbody');
      tbody.innerHTML = '';
      (data.top_signals || []).forEach(s => {
        const tr = document.createElement('tr');
        tr.innerHTML = `<td>${s.symbol}</td><td>${s.ai_verdict_normalized}</td><td>${(s.confidence||0).toFixed(1)}%</td>
                        <td class="recommendation-cell"></td>
                        <td class="ai-verdict-cell" style="display: none;"></td>
                    </tr>`;
        tbody.appendChild(tr);
      });
    }
    refresh();
  </script>
</body>
</html>
{% extends "_layout.html" %}

{% block title %}Options{% endblock %}

{% block content %}
<div class="container">
    <div class="flex justify-between items-center mb-4">
        <h2 class="text-lg font-bold">Options Strategies</h2>
        <div class="toolbar">
            <button class="btn" onclick="refreshData()">Refresh</button>
        </div>
    </div>

    <div class="table-wrap">
        <table>
            <thead>
                <tr>
                    <th>Symbol</th>
                    <th>Strategy</th>
                    <th>Premium</th>
                    <th>Max Profit</th>
                    <th>Max Loss</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody id="options-table-body">
                <!-- Data will be loaded here -->
            </tbody>
        </table>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
// Load options data
async function loadOptions() {
    try {
        const response = await fetch('/api/options/strangle/candidates');
        const data = await response.json();

        const tbody = document.getElementById('options-table-body');
        tbody.innerHTML = data.candidates.map(item => `
            <tr>
                <td>${item.symbol}</td>
                <td>${item.strategy}</td>
                <td>${item.premium}</td>
                <td>${item.max_profit}</td>
                <td>${item.max_loss}</td>
                <td>
                    <button class="pin-btn" onclick="togglePin('${item.symbol}')">
                        ‚≠ê
                    </button>
                </td>
            </tr>
        `).join('');
    } catch (error) {
        console.error('Error loading options:', error);
    }
}

function refreshData() {
    loadOptions();
}

function togglePin(symbol) {
    // Pin/unpin functionality
    console.log('Toggle pin for:', symbol);
}

// Load data on page load
document.addEventListener('DOMContentLoaded', loadOptions);
</script>
{% endblock %}
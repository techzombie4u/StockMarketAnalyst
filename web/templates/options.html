
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Options Strategies - Enhanced Layout</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='css/app.css') }}">
    <style>
        :root {
            --bg-primary: #0b1220;
            --bg-surface: #111a2e;
            --border-color: rgba(255, 255, 255, 0.1);
            --text-primary: rgba(255, 255, 255, 0.9);
            --text-dim: rgba(255, 255, 255, 0.6);
            --brand-color: #6ee7b7;
            --emerald-bg: rgba(16, 185, 129, 0.1);
            --emerald-border: rgba(16, 185, 129, 0.2);
            --sky-bg: rgba(14, 165, 233, 0.1);
            --sky-border: rgba(14, 165, 233, 0.2);
            --rose-bg: rgba(244, 63, 94, 0.1);
            --rose-border: rgba(244, 63, 94, 0.2);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, sans-serif;
            background: var(--bg-primary);
            color: var(--text-primary);
            min-height: 100vh;
            line-height: 1.5;
        }

        .header {
            position: sticky;
            top: 0;
            z-index: 40;
            background: var(--bg-surface);
            border-bottom: 1px solid var(--border-color);
        }

        .header-content {
            max-width: 1280px;
            margin: 0 auto;
            padding: 0.75rem 1rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
            gap: 0.75rem;
        }

        .header-title {
            font-size: 1.25rem;
            font-weight: 700;
            color: white;
        }

        .header-subtitle {
            font-size: 0.75rem;
            color: var(--text-dim);
            margin-top: 0.125rem;
        }

        .nav {
            display: flex;
            gap: 0.5rem;
            font-size: 0.875rem;
        }

        .nav-link {
            padding: 0.5rem 0.75rem;
            border-radius: 0.75rem;
            border: 1px solid var(--border-color);
            color: rgba(255, 255, 255, 0.8);
            text-decoration: none;
            transition: background-color 0.2s;
        }

        .nav-link:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .nav-link.active {
            color: var(--brand-color);
            font-weight: 600;
        }

        .main {
            max-width: 1280px;
            margin: 0 auto;
            padding: 1rem;
            display: flex;
            flex-direction: column;
            gap: 1rem;
        }

        .surface {
            background: var(--bg-surface);
            border: 1px solid var(--border-color);
            border-radius: 1rem;
            padding: 1rem;
        }

        .filters {
            display: flex;
            flex-wrap: wrap;
            align-items: center;
            gap: 0.75rem;
        }

        .filter-item {
            padding: 0.25rem 0.5rem;
            border-radius: 0.5rem;
            background: rgba(255, 255, 255, 0.05);
            color: rgba(255, 255, 255, 0.8);
            font-size: 0.875rem;
        }

        .filter-item span {
            font-weight: 600;
            color: white;
        }

        .filter-controls {
            margin-left: auto;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            font-size: 0.875rem;
        }

        .range-input {
            width: 10rem;
        }

        .btn-primary {
            padding: 0.5rem 0.75rem;
            border-radius: 0.75rem;
            border: 1px solid var(--border-color);
            background: transparent;
            color: var(--brand-color);
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.2s;
        }

        .btn-primary:hover {
            background: var(--emerald-bg);
        }

        .accuracy-toggle {
            display: inline-flex;
            border-radius: 0.75rem;
            overflow: hidden;
            border: 1px solid var(--border-color);
        }

        .accuracy-btn {
            padding: 0.375rem 0.75rem;
            background: transparent;
            border: none;
            color: rgba(255, 255, 255, 0.8);
            cursor: pointer;
            transition: all 0.2s;
        }

        .accuracy-btn:hover {
            background: rgba(255, 255, 255, 0.05);
        }

        .accuracy-btn.active {
            background: var(--emerald-bg);
            color: var(--brand-color);
        }

        .accuracy-btn:not(:first-child) {
            border-left: 1px solid var(--border-color);
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 0.75rem;
        }

        .stat-card {
            background: var(--bg-surface);
            border: 1px solid var(--border-color);
            border-radius: 1rem;
            padding: 1rem;
            min-width: 180px;
        }

        .stat-card.highlight {
            outline: 1px solid rgba(110, 231, 183, 0.3);
        }

        .stat-label {
            font-size: 0.6875rem;
            text-transform: uppercase;
            letter-spacing: 0.05em;
            font-weight: 600;
            color: var(--text-dim);
        }

        .stat-value {
            margin-top: 0.25rem;
            font-size: 1.5rem;
            font-weight: 700;
            color: rgba(255, 255, 255, 0.95);
        }

        .section-header {
            display: flex;
            align-items: center;
            justify-content: space-between;
            margin-bottom: 0.75rem;
        }

        .section-title {
            font-size: 0.875rem;
            font-weight: 600;
            color: var(--text-dim);
        }

        .timeframe-select {
            padding: 0.375rem 0.75rem;
            border-radius: 0.75rem;
            border: 1px solid var(--border-color);
            background: transparent;
            color: var(--text-primary);
            font-size: 0.875rem;
        }

        .table-container {
            border-radius: 1rem;
            overflow: auto;
            border: 1px solid var(--border-color);
            max-width: 100%;
        }

        .table {
            width: 100%;
            min-width: 1800px;
            table-layout: auto;
            font-size: 0.8125rem;
            background: var(--bg-surface);
        }

        .table thead {
            position: sticky;
            top: 0;
            z-index: 10;
        }

        .table th {
            padding: 0.5rem 0.75rem;
            font-weight: 500;
            text-align: left;
            color: rgba(255, 255, 255, 0.7);
            background: rgba(255, 255, 255, 0.05);
            white-space: nowrap;
            min-width: 80px;
        }

        .table td {
            padding: 0.5rem 0.75rem;
            vertical-align: middle;
            white-space: nowrap;
            overflow: hidden;
            text-overflow: ellipsis;
        }

        /* Specific column widths */
        .table th:nth-child(1), .table td:nth-child(1) { min-width: 100px; } /* Stock */
        .table th:nth-child(2), .table td:nth-child(2) { min-width: 100px; } /* Verdict */
        .table th:nth-child(3), .table td:nth-child(3) { min-width: 100px; } /* AI Verdict */
        .table th:nth-child(4), .table td:nth-child(4) { min-width: 120px; } /* Final Outcome */
        .table th:nth-child(5), .table td:nth-child(5) { min-width: 80px; }  /* Spot */
        .table th:nth-child(6), .table td:nth-child(6) { min-width: 80px; }  /* Call */
        .table th:nth-child(7), .table td:nth-child(7) { min-width: 80px; }  /* Put */
        .table th:nth-child(8), .table td:nth-child(8) { min-width: 100px; } /* Due Date */
        .table th:nth-child(9), .table td:nth-child(9) { min-width: 160px; } /* Breakeven Range */
        .table th:nth-child(10), .table td:nth-child(10) { min-width: 100px; } /* Breakout Prob */
        .table th:nth-child(11), .table td:nth-child(11) { min-width: 120px; } /* Market Stability */
        .table th:nth-child(12), .table td:nth-child(12) { min-width: 80px; }  /* Event */
        .table th:nth-child(13), .table td:nth-child(13) { min-width: 120px; } /* Max Loss (2σ) */
        .table th:nth-child(14), .table td:nth-child(14) { min-width: 100px; } /* Stop Loss % */
        .table th:nth-child(15), .table td:nth-child(15) { min-width: 60px; }  /* DTE */
        .table th:nth-child(16), .table td:nth-child(16) { min-width: 70px; }  /* IV% */
        .table th:nth-child(17), .table td:nth-child(17) { min-width: 80px; }  /* IV Rank */
        .table th:nth-child(18), .table td:nth-child(18) { min-width: 100px; } /* Net Credit */
        .table th:nth-child(19), .table td:nth-child(19) { min-width: 100px; } /* Theta/Day */
        .table th:nth-child(20), .table td:nth-child(20) { min-width: 120px; } /* ROI on Margin */

        .table tbody tr:nth-child(even) {
            background: rgba(255, 255, 255, 0.02);
        }

        .outcome-pill {
            padding: 0.125rem 0.5rem;
            border-radius: 0.5rem;
            border: 1px solid;
            font-size: 0.6875rem;
            font-weight: 500;
            display: inline-block;
        }

        .outcome-met {
            color: var(--brand-color);
            background: var(--emerald-bg);
            border-color: var(--emerald-border);
        }

        .outcome-not-met {
            color: #fca5a5;
            background: var(--rose-bg);
            border-color: var(--rose-border);
        }

        .outcome-in-progress {
            color: #7dd3fc;
            background: var(--sky-bg);
            border-color: var(--sky-border);
        }

        .outcome-default {
            color: rgba(255, 255, 255, 0.7);
            background: rgba(255, 255, 255, 0.05);
            border-color: var(--border-color);
        }

        .stock-symbol {
            font-weight: 600;
            color: rgba(255, 255, 255, 0.9);
        }

        .verdict-text {
            color: var(--brand-color);
            font-weight: 500;
        }

        .ai-verdict-text {
            color: #7dd3fc;
            font-weight: 500;
        }

        .empty-state {
            padding: 1.5rem;
            text-align: center;
            color: var(--text-dim);
        }

        .loading {
            padding: 1.5rem;
            text-align: center;
            color: var(--text-dim);
        }

        .accuracy-info {
            font-size: 0.6875rem;
            color: var(--text-dim);
            text-align: right;
        }

        @media (max-width: 768px) {
            .header-content {
                flex-direction: column;
                gap: 0.5rem;
            }

            .nav {
                flex-wrap: wrap;
                justify-content: center;
            }

            .filter-controls {
                margin-left: 0;
                flex-direction: column;
                gap: 0.5rem;
            }

            .stats-grid {
                grid-template-columns: repeat(2, 1fr);
            }

            .table {
                font-size: 0.75rem;
                min-width: 1600px;
            }

            .table th,
            .table td {
                padding: 0.375rem 0.5rem;
            }
        }

        @media (max-width: 640px) {
            .stats-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <header class="header">
        <div class="header-content">
            <div>
                <h1 class="header-title">Stock Market Analyst</h1>
                <p class="header-subtitle">Options – Short Strangle · NSE Equity Options</p>
            </div>
            <nav class="nav">
                <a href="/dashboard" class="nav-link">Dashboard</a>
                <a href="/equities" class="nav-link">Equities</a>
                <a href="/options" class="nav-link active">Options</a>
                <a href="/commodities" class="nav-link">Commodities</a>
                <a href="/papertrade" class="nav-link">Paper Trade</a>
            </nav>
        </div>
    </header>

    <main class="main">
        <!-- Filters Section -->
        <section class="surface">
            <div class="filters">
                <div class="filter-item">Strategy: <span>Short Strangle</span></div>
                <div class="filter-item">Market: <span>NSE Equity Options</span></div>
                <label style="display: flex; align-items: center; gap: 0.5rem; font-size: 0.875rem;">
                    <input type="checkbox" id="hideEvents" checked style="accent-color: var(--brand-color);">
                    Hide Events
                </label>
                <div class="filter-controls">
                    <span style="color: var(--text-dim);">Max Breakout Prob:</span>
                    <input type="range" id="maxBreakoutProb" min="0" max="100" value="100" class="range-input">
                    <span id="breakoutValue">100%</span>
                    <button onclick="loadStrategies()" class="btn-primary">Apply Filters</button>
                </div>
            </div>
        </section>

        <!-- Summary Metrics -->
        <section>
            <div style="display: flex; align-items: center; justify-content: space-between; margin-bottom: 0.5rem;">
                <div style="display: flex; align-items: center; gap: 0.5rem; font-size: 0.75rem;">
                    <span style="color: var(--text-dim);">Accuracy Mode:</span>
                    <div class="accuracy-toggle">
                        <button class="accuracy-btn active" data-mode="micro" onclick="setAccuracyMode('micro')">Micro</button>
                        <button class="accuracy-btn" data-mode="macro" onclick="setAccuracyMode('macro')">Macro</button>
                    </div>
                </div>
                <div class="accuracy-info">
                    Window: <span id="currentTimeframe">45D</span> (finalized only). Micro = successes/(successes+failures). Macro = mean of per-timeframe accuracies.
                </div>
            </div>
            <div class="stats-grid">
                <div class="stat-card highlight" id="microAccCard">
                    <div class="stat-label">Accuracy (Micro)</div>
                    <div class="stat-value" id="microAccValue">0.0%</div>
                </div>
                <div class="stat-card" id="macroAccCard">
                    <div class="stat-label">Accuracy (Macro)</div>
                    <div class="stat-value" id="macroAccValue">0.0%</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Total Strategies</div>
                    <div class="stat-value" id="totalStrategies">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Avg. ROI</div>
                    <div class="stat-value" id="avgROI">0.0%</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">High IV Opportunities</div>
                    <div class="stat-value" id="highIVCount">0</div>
                </div>
                <div class="stat-card">
                    <div class="stat-label">Event‑Free Trades</div>
                    <div class="stat-value" id="eventFreeCount">0</div>
                </div>
            </div>
        </section>

        <!-- Strategies Table -->
        <section class="surface">
            <div class="section-header">
                <h3 class="section-title">Enhanced Options Strategies — <span id="strategiesTimeframe">45D</span></h3>
                <div style="display: flex; align-items: center; gap: 0.5rem; font-size: 0.875rem;">
                    <label style="color: var(--text-dim); display: none;" class="sm:block">DTE Window:</label>
                    <select id="timeframeSelect" class="timeframe-select">
                        <option value="45D">45D — Recommended</option>
                        <option value="30D">30D — Recommended</option>
                        <option value="21D">21D — Practical Min</option>
                        <option value="14D">14D — Practical Min</option>
                        <option value="10D">10D — Weekly</option>
                        <option value="7D">7D — Weekly</option>
                    </select>
                </div>
            </div>
            <div class="table-container">
                <table class="table">
                    <thead>
                        <tr>
                            <th>Stock</th>
                            <th>Verdict</th>
                            <th>AI Verdict</th>
                            <th>Final Outcome</th>
                            <th>Spot</th>
                            <th>Call</th>
                            <th>Put</th>
                            <th>Due Date</th>
                            <th>Breakeven Range</th>
                            <th>Breakout Prob</th>
                            <th>Market Stability</th>
                            <th>Event</th>
                            <th>Max Loss (2σ)</th>
                            <th>Stop Loss %</th>
                            <th>DTE</th>
                            <th>IV%</th>
                            <th>IV Rank</th>
                            <th>Net Credit</th>
                            <th>Theta/Day</th>
                            <th>ROI on Margin</th>
                        </tr>
                    </thead>
                    <tbody id="strategiesTableBody">
                        <tr>
                            <td colspan="20" class="loading">Loading enhanced options strategies...</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>

        <!-- Active Predictions Table -->
        <section class="surface">
            <h3 class="section-title">Active Predictions (Real‑time)</h3>
            <div class="table-container">
                <table class="table">
                    <thead>
                        <tr>
                            <th>Due Date</th>
                            <th>Stock</th>
                            <th>Predicted Outcome</th>
                            <th>Current Outcome</th>
                            <th>Predicted ROI</th>
                            <th>Current ROI</th>
                            <th>Reason (if changed)</th>
                        </tr>
                    </thead>
                    <tbody id="activePredictionsBody">
                        <tr>
                            <td colspan="7" class="loading">Loading active predictions...</td>
                        </tr>
                    </tbody>
                </table>
            </div>
        </section>
    </main>

    <script>
        let currentTimeframe = '45D';
        let currentAccuracyMode = 'micro';
        let strategiesData = [];
        let accuracyData = [];
        let activePredictions = [];

        // Initialize page
        document.addEventListener('DOMContentLoaded', function() {
            setupEventListeners();
            loadAllData();
            
            // Auto-refresh every 30 seconds
            setInterval(loadAllData, 30000);
        });

        function setupEventListeners() {
            // Timeframe selector
            document.getElementById('timeframeSelect').addEventListener('change', function() {
                currentTimeframe = this.value;
                document.getElementById('currentTimeframe').textContent = currentTimeframe;
                document.getElementById('strategiesTimeframe').textContent = currentTimeframe;
                loadAllData();
            });

            // Breakout probability range
            document.getElementById('maxBreakoutProb').addEventListener('input', function() {
                document.getElementById('breakoutValue').textContent = this.value + '%';
            });
        }

        function setAccuracyMode(mode) {
            currentAccuracyMode = mode;
            
            // Update button states
            document.querySelectorAll('.accuracy-btn').forEach(btn => {
                btn.classList.remove('active');
            });
            document.querySelector(`[data-mode="${mode}"]`).classList.add('active');
            
            // Update card highlights
            document.getElementById('microAccCard').classList.toggle('highlight', mode === 'micro');
            document.getElementById('macroAccCard').classList.toggle('highlight', mode === 'macro');
        }

        async function loadAllData() {
            try {
                // Load strategies
                await loadStrategies();
                
                // Load accuracy data
                await loadAccuracy();
                
                // Load active predictions
                await loadActivePredictions();
                
            } catch (error) {
                console.error('Error loading data:', error);
            }
        }

        async function loadStrategies() {
            try {
                const response = await fetch(`/api/options/strategies?timeframe=${currentTimeframe}`);
                const data = await response.json();
                
                if (data.success && data.strategies) {
                    strategiesData = data.strategies;
                    renderStrategiesTable();
                    updateSummaryMetrics();
                } else {
                    showTableError('strategiesTableBody', 'Failed to load strategies data', 20);
                }
            } catch (error) {
                console.error('Error loading strategies:', error);
                showTableError('strategiesTableBody', 'Error loading strategies: ' + error.message, 20);
            }
        }

        async function loadAccuracy() {
            try {
                const window = currentTimeframe.toLowerCase();
                const response = await fetch(`/api/predictions/accuracy?window=${window}`);
                const data = await response.json();
                
                if (data.success && data.by_timeframe) {
                    accuracyData = data.by_timeframe;
                    updateAccuracyMetrics();
                } else {
                    console.warn('No accuracy data available');
                    updateAccuracyMetrics([]);
                }
            } catch (error) {
                console.error('Error loading accuracy:', error);
                updateAccuracyMetrics([]);
            }
        }

        async function loadActivePredictions() {
            try {
                const response = await fetch('/api/predictions/active');
                const data = await response.json();
                
                if (data.success && data.items) {
                    activePredictions = data.items;
                    renderActivePredictions();
                } else {
                    showTableError('activePredictionsBody', 'No active predictions available', 7);
                }
            } catch (error) {
                console.error('Error loading active predictions:', error);
                showTableError('activePredictionsBody', 'Error loading active predictions: ' + error.message, 7);
            }
        }

        function renderStrategiesTable() {
            const tbody = document.getElementById('strategiesTableBody');
            
            if (!strategiesData || strategiesData.length === 0) {
                tbody.innerHTML = '<tr><td colspan="20" class="empty-state">No strategies available for the selected timeframe</td></tr>';
                return;
            }

            const rows = strategiesData.map(strategy => `
                <tr>
                    <td><div class="stock-symbol">${strategy.stock || 'N/A'}</div></td>
                    <td><span class="verdict-text">${strategy.verdict || 'Hold'}</span></td>
                    <td><span class="ai-verdict-text">${strategy.ai_verdict || 'On Track'}</span></td>
                    <td>${renderOutcomePill(strategy.final_outcome)}</td>
                    <td>₹${formatNumber(strategy.spot)}</td>
                    <td>₹${formatNumber(strategy.call)}</td>
                    <td>₹${formatNumber(strategy.put)}</td>
                    <td>${formatDueDate(strategy)}</td>
                    <td>₹${formatNumber(strategy.breakeven_min)} – ₹${formatNumber(strategy.breakeven_max)}</td>
                    <td>${Math.round((strategy.breakout_prob || 0) * 100)}%</td>
                    <td>${strategy.market_stability || '—'}</td>
                    <td>${strategy.event || '—'}</td>
                    <td>${strategy.max_loss_2s || '—'}</td>
                    <td>${strategy.stop_loss_pct || '—'}%</td>
                    <td>${strategy.dte || '—'}</td>
                    <td>${strategy.iv || '—'}%</td>
                    <td>${strategy.iv_rank || '—'}</td>
                    <td>₹${formatNumber(strategy.net_credit)}</td>
                    <td>${strategy.theta_day || '—'}</td>
                    <td>${strategy.roi_on_margin || '—'}%</td>
                </tr>
            `).join('');

            tbody.innerHTML = rows;
        }

        function renderActivePredictions() {
            const tbody = document.getElementById('activePredictionsBody');
            
            if (!activePredictions || activePredictions.length === 0) {
                tbody.innerHTML = '<tr><td colspan="7" class="empty-state">No active trades in progress</td></tr>';
                return;
            }

            const rows = activePredictions.map(pred => `
                <tr>
                    <td>${pred.due || '—'}</td>
                    <td><div class="stock-symbol">${pred.stock || 'N/A'}</div></td>
                    <td>${pred.predicted || '—'}</td>
                    <td>${pred.current || '—'}</td>
                    <td>${pred.proi || '—'}%</td>
                    <td>${pred.croi || '—'}%</td>
                    <td>${pred.reason || '—'}</td>
                </tr>
            `).join('');

            tbody.innerHTML = rows;
        }

        function updateSummaryMetrics() {
            const total = strategiesData.length;
            const avgROI = total > 0 ? strategiesData.reduce((sum, s) => sum + (Number(s.roi_on_margin) || 0), 0) / total : 0;
            const highIV = strategiesData.filter(s => (s.iv_rank || 0) >= 50).length;
            const eventFree = strategiesData.filter(s => s.event === '—' || !s.event).length;

            document.getElementById('totalStrategies').textContent = total;
            document.getElementById('avgROI').textContent = avgROI.toFixed(1) + '%';
            document.getElementById('highIVCount').textContent = highIV;
            document.getElementById('eventFreeCount').textContent = eventFree;
        }

        function updateAccuracyMetrics() {
            if (!accuracyData || accuracyData.length === 0) {
                document.getElementById('microAccValue').textContent = '0.0%';
                document.getElementById('macroAccValue').textContent = '0.0%';
                return;
            }

            let totalSuccess = 0, totalFailed = 0, ratios = [];
            
            accuracyData.forEach(item => {
                const success = Number(item.success || 0);
                const failed = Number(item.failed || 0);
                const total = success + failed;
                
                totalSuccess += success;
                totalFailed += failed;
                
                if (total > 0) {
                    ratios.push(success / total);
                }
            });

            const microAcc = (totalSuccess + totalFailed) > 0 ? totalSuccess / (totalSuccess + totalFailed) : 0;
            const macroAcc = ratios.length > 0 ? ratios.reduce((a, b) => a + b, 0) / ratios.length : 0;

            document.getElementById('microAccValue').textContent = (microAcc * 100).toFixed(1) + '%';
            document.getElementById('macroAccValue').textContent = (macroAcc * 100).toFixed(1) + '%';
        }

        function renderOutcomePill(outcome) {
            let className = 'outcome-pill ';
            switch (outcome) {
                case 'MET':
                    className += 'outcome-met';
                    break;
                case 'NOT_MET':
                    className += 'outcome-not-met';
                    break;
                case 'IN_PROGRESS':
                    className += 'outcome-in-progress';
                    break;
                default:
                    className += 'outcome-default';
                    outcome = outcome || '—';
            }
            return `<span class="${className}">${outcome}</span>`;
        }

        function formatNumber(value) {
            if (value === null || value === undefined) return '0.00';
            return new Intl.NumberFormat('en-IN', { maximumFractionDigits: 2 }).format(Number(value));
        }

        function formatDueDate(strategy) {
            if (strategy.due_date) return strategy.due_date;
            
            const days = Number(strategy.dte);
            if (Number.isFinite(days)) {
                const date = new Date();
                date.setDate(date.getDate() + days);
                return date.toISOString().split('T')[0];
            }
            return '—';
        }

        function showTableError(tbodyId, message, colSpan) {
            const tbody = document.getElementById(tbodyId);
            tbody.innerHTML = `<tr><td colspan="${colSpan}" class="empty-state">${message}</td></tr>`;
        }
    </script>
</body>
</html>

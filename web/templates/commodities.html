{% extends "_layout.html" %}

{% block title %}Commodities{% endblock %}

{% block content %}
<div class="container">
    <div class="flex justify-between items-center mb-4">
        <h2 class="text-lg font-bold">Commodities</h2>
        <div class="toolbar">
            <button class="btn" onclick="refreshData()">Refresh</button>
        </div>
    </div>

    <div class="table-wrap">
        <table>
            <thead>
                <tr>
                    <th>Commodity</th>
                    <th>Price</th>
                    <th>Change</th>
                    <th>Signal</th>
                    <th>Correlation</th>
                    <th>Action</th>
                </tr>
            </thead>
            <tbody id="commodities-table-body">
                <!-- Data will be loaded here -->
            </tbody>
        </table>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
// Load commodities data
async function loadCommodities() {
    try {
        const response = await fetch('/api/commodities/signals');
        const data = await response.json();

        const tbody = document.getElementById('commodities-table-body');
        tbody.innerHTML = data.signals.map(item => `
            <tr>
                <td>${item.symbol}</td>
                <td>${item.price}</td>
                <td class="${item.change >= 0 ? 'status-active' : 'status-error'}">
                    ${item.change}%
                </td>
                <td>
                    <span class="badge ${item.signal === 'BUY' ? 'badge-ok' : item.signal === 'SELL' ? 'badge-danger' : 'badge-warn'}">
                        ${item.signal}
                    </span>
                </td>
                <td>${item.correlation}</td>
                <td>
                    <button class="pin-btn" onclick="togglePin('${item.symbol}')">
                        ‚≠ê
                    </button>
                </td>
            </tr>
        `).join('');
    } catch (error) {
        console.error('Error loading commodities:', error);
    }
}

function refreshData() {
    loadCommodities();
}

function togglePin(symbol) {
    // Pin/unpin functionality
    console.log('Toggle pin for:', symbol);
}

// Load data on page load
document.addEventListener('DOMContentLoaded', loadCommodities);
</script>
{% endblock %}